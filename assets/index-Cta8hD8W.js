var de=Object.getPrototypeOf;var fe=Reflect.get;var l=(c,e,t)=>fe(de(c),t,e);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function t(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(r){if(r.ep)return;r.ep=!0;const a=t(r);fetch(r.href,a)}})();const j=class j{constructor(){this.elements=[]}addElement(e){this.elements.unshift(e)}evaluate(){for(const e of this.elements)e.evaluate([])}toString(){let e=`ComputationStack: {
`;for(const t of this.elements)e+=`  ${t.toString()}
`;return e+="}",e}};j.instance=new j;let T=j;const B=1e4;class h{constructor(){this.scopes=[{}]}setVariable(e,t){if(this.scopes.length===0){console.error("No scopes available to set a variable.");return}for(let s=this.scopes.length-1;s>=0;s--)if(e in this.scopes[s]){this.scopes[s][e]=t,this.onUpdate();return}this.scopes[this.scopes.length-1][e]=t,this.onUpdate()}defineLocalVariable(e,t){if(this.scopes.length===0){console.error("No scopes available to set a variable."),this.onUpdate();return}this.scopes[this.scopes.length-1][e]=t,this.onUpdate()}getVariable(e){for(let t=this.scopes.length-1;t>=0;t--)if(e in this.scopes[t])return this.scopes[t][e];console.error(`Variable "${e}" not found in any scope.`)}hasVariable(e){for(let t=this.scopes.length-1;t>=0;t--)if(e in this.scopes[t])return!0;return!1}push(){if(this.scopes.length>B){I.throwError(`Reached Limit of ${B} scopes. Cannot push a new scope.`);return}this.scopes.push({}),this.onUpdate()}pop(){this.scopes.length>1?this.scopes.pop():console.error("No scopes to pop from the stack."),this.onUpdate()}onUpdate(){}toString(){return JSON.stringify(this.scopes,null,2)}}const g=class g{constructor(){}static reset(){h.instance=new h,T.instance.elements=[],g.output="",g.shouldStop=!1}static interpret(){const e=T.instance,t=[];for(;e.elements.length>0&&!g.shouldStop;){const s=e.elements.pop(),r=[],a=s.constructor.numParameters;for(let i=0;i<a;i++)t.length>0?r.unshift(t.pop()):console.error("Not enough arguments for function:",s.constructor.name);const o=s.evaluate(r);t.push(o)}return g.output}static log(e){g.output+=e+`
`}static throwError(e){g.output+="Error: "+e+`
`,console.error("Error:",e),g.shouldStop=!0}};g.reset();let I=g;const J=class J{static addExpression(e){this.expressions.push(e)}static parse(e){const t=new T;e=xe(e);const s=[];this.expressions.sort((o,i)=>o.isExpandable!==i.isExpandable?o.isExpandable?-1:1:i.precedence-o.precedence);for(const o of this.expressions){const i=Array();let p;for(;(p=o.findMatch(e))!==null;){const d=p[0].length;e=e.slice(0,p.index)+" ".repeat(d)+e.slice(p.index+d),i.push(p)}for(const d of i){const X={instance:new o(d.slice(1)),index:d.index};let Z=s.findIndex(me=>me.index>X.index);Z===-1?s.push(X):s.splice(Z,0,X)}}const r=[],a=[];for(const o of s){const i=o.instance,p=i.constructor.numParameters;if(p<=0){t.addElement(i);const d=()=>{a[a.length-1]<=1?(a.pop(),t.addElement(r.pop()),d()):a[a.length-1]-=1};d()}else r.push(i),a.push(p)}T.instance.elements.push(...t.elements)}};J.expressions=[];let M=J;function xe(c){return c=c.replace(/\/\/.*$/gm,""),c=c.replace(/\s+/g," ").trim(),c}const q=class q{constructor(e){this.match=e}toString(){return`{${this.constructor.name}: ${this.match}}`}static findMatch(e){return null}static register(){M.addExpression(this)}};q.precedence=0,q.numParameters=0;let f=q;const K=class K extends f{constructor(e){super(e)}static findMatch(e){return new RegExp(`${this.symbol}`,"g").exec(e)??null}static register(){super.register(),this.precedence=this.symbol.length}};K.symbol="UNKNOWN",K.numParameters=0;let u=K;class n{constructor(e){this.value=e,this.value=e}getValue(){return this.value}evaluate(){return this}}const v=class v extends u{constructor(e){super(e)}evaluate(e){for(const t of e)I.log(t.evaluate([]).getValue().toString());return new n(-1)}};v.symbol="P",v.numParameters=1,l(v,v,"register").call(this);let G=v;const w=class w extends u{constructor(e){super(e)}evaluate(e){const t=e[0].evaluate([]).getValue(),s=e[1].evaluate([]).getValue();return new n(t+s)}};w.symbol="A",w.numParameters=2,l(w,w,"register").call(this);let L=w;const y=class y extends u{constructor(e){super(e)}evaluate(e){const t=e[0].evaluate([]).getValue(),s=e[1].evaluate([]).getValue();return new n(t/s)}};y.symbol="D",y.numParameters=2,l(y,y,"register").call(this);let D=y;const b=class b extends u{constructor(e){super(e)}evaluate(e){const t=e[0].evaluate([]).getValue(),s=e[1].evaluate([]).getValue();return new n(t*s)}};b.symbol="X",b.numParameters=2,l(b,b,"register").call(this);let Q=b;const E=class E extends u{constructor(e){super(e)}evaluate(e){const t=e[0].evaluate([]).getValue(),s=e[1].evaluate([]).getValue();return new n(t-s)}};E.symbol="S",E.numParameters=2,l(E,E,"register").call(this);let F=E;const Y=class Y extends f{constructor(e){super(e)}evaluate(e){return new n(1)}static findMatch(e){return new RegExp(`${this.symbol}\\s*([a-z]+)`,"g").exec(e)??null}static register(){super.register(),this.precedence=this.symbol.length+1e3}};Y.numParameters=0;let x=Y;const V=class V extends x{constructor(e){super(e)}evaluate(e){const t=e[0].evaluate([]).getValue();return h.instance.defineLocalVariable(this.match[0],t),new n(-1)}};V.symbol="D",V.numParameters=1,l(V,V,"register").call(this);let _=V;const $=class $ extends x{constructor(e){super(e)}evaluate(e){const t=e[0].evaluate([]).getValue();return h.instance.setVariable(this.match[0],t),new n(-1)}};$.symbol="S",$.numParameters=1,l($,$,"register").call(this);let ee=$;const k=class k extends x{constructor(e){super(e)}evaluate(){const e=h.instance.getVariable(this.match[0]);return new n(e)}};k.symbol="G",l(k,k,"register").call(this);let te=k;const O=class O extends u{constructor(e){super(e)}evaluate(e){return h.instance.pop(),new n(-1)}};O.symbol="POP",O.numParameters=0,l(O,O,"register").call(this);let se=O;const U=class U extends u{constructor(e){super(e)}evaluate(e){return h.instance.push(),new n(-1)}};U.symbol="PUSH",U.numParameters=0,l(U,U,"register").call(this);let re=U;const C=class C extends u{constructor(e){super(e)}evaluate(e){return M.parse(e[0].evaluate([]).getValue()),new n(-1)}};C.symbol="EVAL",C.numParameters=1,l(C,C,"register").call(this);let ae=C;const N=class N extends u{constructor(e){super(e)}evaluate(e){return e[0].evaluate([]).getValue()>0&&M.parse(e[1].evaluate([]).getValue()),new n(-1)}};N.symbol="EVALIF",N.numParameters=2,l(N,N,"register").call(this);let ce=N;const W=class W extends x{constructor(e){super(e)}evaluate(){const e=this.match[0],t=h.instance.getVariable(e);if(t instanceof Array){const s=t.pop();return h.instance.onUpdate(),new n(s)}return new n(-1)}};W.symbol="POP",l(W,W,"register").call(this);let ne=W;const R=class R extends x{constructor(e){super(e)}evaluate(e){const t=this.match[0],s=h.instance.getVariable(t);return s instanceof Array?(s.push(e[0].evaluate([]).getValue()),h.instance.onUpdate(),new n(-1)):new n(0)}};R.symbol="PUSH",R.numParameters=1,l(R,R,"register").call(this);let oe=R;const z=class z extends x{constructor(e){super(e)}evaluate(){const e=this.match[0],t=h.instance.getVariable(e);if(t instanceof Array){const s=t.shift();return h.instance.onUpdate(),new n(s)}return new n(-1)}};z.symbol="SHIFT",l(z,z,"register").call(this);let le=z;const S=class S extends f{constructor(e){super(e);const t=e[0];let s=0;for(let r=0;r<t.length;r++){const a=t.charCodeAt(r);if(a==122)s=s*26;else{const o=a-97+1;s=s*26+o}}this.value=new n(s)}evaluate(e){return this.value}static findMatch(e){return new RegExp(this.matchExpression).exec(e)??null}};S.matchExpression=/N([a-z]*)/g,S.precedence=1e5,l(S,S,"register").call(this);let ie=S;const A=class A extends f{constructor(e){super(e)}evaluate(e){return new n([])}static findMatch(e){return new RegExp(this.matchExpression).exec(e)??null}};A.matchExpression=/Q/g,A.precedence=1,l(A,A,"register").call(this);let he=A;const P=class P extends f{constructor(e){super(e);const t=e[0];this.value=new n(t=="T"?1:0)}evaluate(e){return this.value}static findMatch(e){return new RegExp(this.matchExpression).exec(e)??null}};P.matchExpression=/B(T|F)/g,P.precedence=2,l(P,P,"register").call(this);let ue=P;const H=class H extends f{constructor(e){super(e),this.value=new n(e[0])}evaluate(e){return this.value}static findMatch(e){let t=0,s=-1;for(let r=0;r<e.length;r++)if(e.slice(r,r+3)==="STR")t===0&&(s=r),t++,r+=2;else if(e.slice(r,r+3)==="END"){if(t--,t===0&&s!==-1){const a=e.slice(s,r+3),o=e.slice(s+3,r);return Object.assign([a,o],{index:s,input:e})}r+=2}return null}};H.precedence=1000001,l(H,H,"register").call(this);let pe=H;function ve(c){return I.reset(),M.parse(c),I.interpret()}window.runCode=()=>{const c=document.getElementById("codeInput").value,e=ve(c);document.getElementById("output").textContent=e};const m=document.querySelector("textarea"),we=()=>{const{value:c,selectionStart:e,selectionEnd:t}=m,s=c.lastIndexOf(`
`,e-1)+1,a=c.substring(s,e).match(/^\s*/)[0],o=" ".repeat(4),i=a.replace(/\t/g,o);m.value=`${c.substring(0,e)}
${i}${c.substring(t)}`;const p=e+1+i.length;m.selectionStart=m.selectionEnd=p};m.addEventListener("keydown",c=>{if(c.key==="Tab"){c.preventDefault();const{value:e,selectionStart:t,selectionEnd:s}=m,r=" ".repeat(4);m.value=`${e.substring(0,t)}${r}${e.substring(s)}`,m.selectionStart=m.selectionEnd=t+r.length}else c.key==="Enter"&&(c.preventDefault(),we())});
